{% extends "base.html" %}

{% block title %}Home - PiSafe{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h1 class="mb-4">PiSafe - IoT Security Gateway</h1>
        <p class="lead">Active vulnerability scanning with multi-intensity modes and CVE detection</p>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <h5 class="card-title">Total Devices Scanned</h5>
                <h2 class="card-text">{{ device_count }}</h2>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card text-white bg-danger">
            <div class="card-body">
                <h5 class="card-title">High Risk Devices</h5>
                <h2 class="card-text">{{ high_risk_count }}</h2>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header bg-dark text-white">
                <h5 class="mb-0">Start Network Scan</h5>
            </div>
            <div class="card-body">
                <form action="/scan" method="POST">
                    <div class="mb-3">
                        <label for="subnet" class="form-label">Subnet / IP Address</label>
                        <input type="text" class="form-control" id="subnet" name="subnet" 
                               placeholder="e.g., 192.168.1.0/24 or 127.0.0.1" required>
                        <div class="form-text">Enter a subnet in CIDR notation or a single IP address</div>
                    </div>

                    <div class="mb-3">
                        <label for="intensity" class="form-label">Scan Intensity</label>
                        <select class="form-select" id="intensity" name="intensity">
                            <option value="Stealth">Stealth - Minimal noise, low footprint</option>
                            <option value="Balanced" selected>Balanced - Moderate scan (recommended)</option>
                            <option value="Aggressive">Aggressive - Fast and detailed scan</option>
                            <option value="Insane">Insane - Maximum speed and depth</option>
                        </select>
                        <div class="form-text">Higher intensity provides more details but may stress the network</div>
                    </div>

                    <div class="mb-3">
                        <label for="auth_mode" class="form-label">Authentication Mode</label>
                        <select class="form-select" id="auth_mode" name="auth_mode">
                            <option value="Safe Scan" selected>Safe Scan - Non-intrusive enumeration</option>
                            <option value="Deep Scan" disabled>Deep Scan - Authenticated checks (Coming Soon)</option>
                        </select>
                        <div class="form-text">Safe Scan avoids login attempts and device crashes</div>
                    </div>

                    <div class="alert alert-warning">
                        <strong>Note:</strong> This application requires <code>nmap</code> to be installed on your system. 
                        On Raspberry Pi or Linux, install it with: <code>sudo apt-get install nmap</code>
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg">
                        <span>üîç</span> Start Scan
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Scan Intensity Modes</h5>
            </div>
            <div class="card-body">
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th>Mode</th>
                            <th>Description</th>
                            <th>Nmap Flags</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge bg-success">Stealth</span></td>
                            <td>Quick, low-noise scan that avoids firewall alerts</td>
                            <td><code>-sS -T1 --top-ports 50</code></td>
                        </tr>
                        <tr>
                            <td><span class="badge bg-primary">Balanced</span></td>
                            <td>Default moderate scan (accurate + safe)</td>
                            <td><code>-sS -sV -T3 --top-ports 100</code></td>
                        </tr>
                        <tr>
                            <td><span class="badge bg-warning">Aggressive</span></td>
                            <td>Fast and detailed scan with version detection</td>
                            <td><code>-sS -sV -O -T4 -p-</code></td>
                        </tr>
                        <tr>
                            <td><span class="badge bg-danger">Insane</span></td>
                            <td>Maximum speed and depth; may stress network</td>
                            <td><code>-A -T5 --script vuln -p-</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
